metrics:
  is_xdp: true
  interfaces: ["enp8s0"] # interfaces to attach to
  counters:
    - name: tcp_udp_map
      help: Shows TCP and UDP packets
      labels:
        - name: src_ip
          size: 4
          decoders:
            - name: inet_ip
        - name: dst_ip
          size: 4
          decoders:
            - name: inet_ip
        - name: src_port
          size: 4
          decoders:
            - name: uint
        - name: dst_port
          size: 4
          decoders:
            - name: uint
        - name: protocol
          size: 4
          decoders:
            - name: uint
            - name: static_map
              static_map:
                6: tcp
                17: udp
    - name: icmp_map
      help: Shows ICMP packets
      labels:
        - name: src_ip
          size: 4
          decoders:
            - name: inet_ip
        - name: dst_ip
          size: 4
          decoders:
            - name: inet_ip
        - name: type
          size: 4
          decoders:
            - name: uint
        - name: code
          size: 4
          decoders:
            - name: uint
        - name: protocol
          size: 4
          decoders:
            - name: uint
            - name: static_map
              static_map:
                1: icmp
